<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta http-equiv="Access-Control-Allow-Origin" content="*">
		<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
		{% if title %}
		<title>{{ title }} - Mixpus</title>
		{% else %}
		<title>Mixpus - Free Cloud Based ERP Solution</title>
		{% endif %}

		<style type="text/css">
			@font-face {
				font-family: 'FontAwesome';
			    src: url('/static/fonts/fontawesome-webfont.eot?v=4.7.0');
			    src: url('/static/fonts/fontawesome-webfont.eot?#iefix&v=4.7.0') format('embedded-opentype'), url('/static/fonts/fontawesome-webfont.woff2?v=4.7.0') format('woff2'), url('/static/fonts/fontawesome-webfont.woff?v=4.7.0') format('woff'), url('/static/fonts/fontawesome-webfont.ttf?v=4.7.0') format('truetype'), url('/static/fonts/fontawesome-webfont.svg?v=4.7.0#fontawesomeregular') format('svg');
			    font-weight: normal;
			    font-style: normal;
			}
			@font-face {
				font-family: 'Glyphicons Halflings';
				src: url('/static/fonts/glyphicons-halflings-regular.eot');
				src: url('/static/fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'), url('/static/fonts/glyphicons-halflings-regular.woff2') format('woff2'), url('/static/fonts/glyphicons-halflings-regular.woff') format('woff'), url('/static/fonts/glyphicons-halflings-regular.ttf') format('truetype'), url('/static/fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular') format('svg');
			}
		</style>

		{% assets "admin_css" %}
		<link href="{{ ASSET_URL }}" type="text/css"  rel="stylesheet">
  		{% endassets %}

		{% block private_styles %}{% endblock %}

		{% assets "app_css" %}
		<link href="{{ ASSET_URL }}" type="text/css" rel="stylesheet">
  		{% endassets %}

		{% assets "themes_css" %}
		<link href="{{ ASSET_URL }}" type="text/css" rel="stylesheet">
  		{% endassets %}

		<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
		<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
		<script src="{{ url_for('static', filename='js/moment-with-locales.min.js') }}" type="text/javascript"></script>
		{{ moment.lang(g.locale) }}
	</head>

	<body>
		{% block header %}
		<header class="admin navbar navbar-masthead navbar-default navbar-fixed-top">
			<div class="container-fluid">
				<div class="navbar-header">
					<button class="navbar-toggle collapsed" type="button" data-target="#bs-navbar" data-toggle="collapse" aria-expanded="false">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a href="{{ url_for('main.index') }}" class="navbar-brand">
						{{ current_site.company_name if current_site }}
					</a>
				</div>
				<nav class="collapse navbar-collapse">
					<ul class="nav navbar-nav">
						<li {% if top_menu == 'dashboard' %}class="active"{% endif %}>
							<a href="{{ url_for('main.index') }}">{{ _('Index') }}</a>
						</li>
						<li {% if top_menu == 'orders' %}class="active"{% endif %}>
							<a href="{{ url_for('main.show_orders') }}">{{ _('Orders') }}</a>
						</li>
						<li {% if top_menu == 'products' %}class="active"{% endif %}>
							<a href="{{ url_for('main.show_products') }}">{{ _('Products') }}</a>
						</li>
						<li {% if top_menu == 'purchases' %}class="active"{% endif %}>
							<a href="{{ url_for('main.show_purchases') }}">{{ _('Purchase') }}</a>
						</li>
						<li {% if top_menu == 'warehouses' %}class="active"{% endif %}>
							<a href="{{ url_for('main.show_stocks') }}">{{ _('Warehouse') }}</a>
						</li>
						<li {% if top_menu == 'logistics' %}class="active"{% endif %}>
							<a href="{{ url_for('main.show_expresses') }}">{{ _('Logistics') }}</a>
						</li>
						<li {% if top_menu == 'service' %}class="active"{% endif %}>
							<a href="{{ url_for('main.show_blacklist') }}">{{ _('Customer Service') }}</a>
						</li>
						<li {% if top_menu == 'finances' %}class="active"{% endif %}>
							<a href="{{ url_for('main.show_payments') }}">{{ _('Finance') }}</a>
						</li>
						<li>
							<a href="{{ url_for('main.stats') }}">{{ _('Reports') }}</a>
						</li>
						<li {% if top_menu == 'settings' %}class="active"{% endif %}>
							<a href="{{ url_for('main.show_settings') }}">{{ _('Settings') }}</a>
						</li>
						{% if current_user.is_admin %}
						<li {% if top_menu == 'system' %}class="active"{% endif %}>
							<a href="{{ url_for('main.show_users') }}">{{ _('System') }}</a>
						</li>
						{% endif %}
					</ul>

					<ul class="nav navbar-nav navbar-right">
						<li>
							<a href="javascript:void(0);" title="{{ _('Select languages') }}" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="true">
								<span class="glyphicon glyphicon-globe"></span>
							</a>
							<ul class="dropdown-menu">
								{% for lang in support_languages %}
								<li {% if g.locale == lang[1] %}class="active"{% endif %}>
									<a href="/{{ lang[1] }}">{{ lang[2] }}</a>
								</li>
								{% endfor %}
							</ul>
						</li>
						<li>
							<a href="javascript:void(0);">
								<span class="glyphicon glyphicon-bell"></span>
							</a>
						</li>
						<li class="dropdown">
							<a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button"  aria-haspopup="true" aria-expanded="true">
								<span class="glyphicon glyphicon-user"></span>
								{% if current_user.is_authenticated %}
									 {{ current_user.username }}
								{% endif %}
							</a>
							<ul class="dropdown-menu">
								<li><a href="{{ url_for('main.preference') }}">{{ _('Preference Setting') }}</a></li>
								<li><a href="{{ url_for('main.passwd') }}">{{ _('Update Password') }}</a></li>
								<li role="separator" class="divider"></li>
								<li><a href="{{ url_for('auth.logout') }}">{{ _('Logout') }}</a></li>
							</ul>
						</li>
					</ul>
				</nav>
			</div>
		</header>
		{% endblock %}

		<div class="container-fluid">
			{% block content %}
			<div class="col-sm-3 col-md-2 sidebar">
				{% block sidebar %}{% endblock %}
			</div>
			<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main" id="pjax-container">
				{% with messages = get_flashed_messages(with_categories=true) %}
					{% if messages %}
					<div class="flashes">
						{% for category, message in messages %}
						<div class="alert alert-{{ category }} alert-dismissable">
							<button class="close" type="button" data-dismiss="alert" aria-hidden="true">×</button>
							{% if category == 'success' %}
							<strong>Well done!</strong>
							{% endif %}

							{% if category == 'danger' %}
							<strong>Oh snap!</strong>
							{% endif %}

							{{ message }}
						</div>
						{% endfor %}
					</div>
					{% endif %}
				{% endwith %}

				{% block mainbar %}{% endblock %}
			</div>
			{% endblock %}
		</div> <!-- /container -->

		{% block footer %}{% endblock %}
		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
		{% assets "admin_js" %}
  		<script type="text/javascript" src="{{ ASSET_URL }}"></script>
  		{% endassets %}

		{% assets "app_js" %}
  		<script type="text/javascript" src="{{ ASSET_URL }}"></script>
  		{% endassets %}

		<script type="text/javascript">
			// 加载js执行前的配置信息
			mixpus.csrf_token = "{{ csrf_token() }}";
			mixpus.locale = {
				selected_label: "{{ _('items selected') }}",
				copy_ok_message: "{{ _('Copy successfully') }}"
			};
			mixpus.language = '{{ g.locale|default("en") }}';
			mixpus.c_lodop_hosts = "192.168.1.22:8000,192.168.1.22:18000";

			// 打开页面时加载进度条。
			NProgress.start();

			$(function(){
				NProgress.done();

				mixpus.hook_pjax_link();

				{% block jquery %}
				// current document scripts
				{% endblock %}
			});
		</script>

		{% block private_js %}{% endblock %}
		{% block after_jquery %}
		<script type="text/javascript">
			$(function () {
				mixpus.init_page_layout();
			});
		</script>
		{% endblock %}

	</body>
</html>