{% extends pjax("layout/base.html") %}

{% block mainbar %}
<div class="list-page">
	<div class="page-header">
		{{ _('Store List') }}
		<span class="pull-right">
			{% include 'block/_select_items.html' %}
			<a href="{{ url_for('main.create_store') }}" data-toggle="tooltip" class="pjax btn btn-mixpus" data-original-title="{{ _('Add New') }}">
				<i class="fa fa-plus"></i>
			</a>
			<button class="btn btn-danger delete-all hidden" data-form-id="stores-form" type="button" data-toggle="tooltip" data-original-title="{{ _('Delete') }}">
				<i class="fa fa-trash"></i>
			</button>
		</span>
	</div>
	
	<div class="table-responsive">
		<table class="table table-bordered table-striped">
			<thead>
				<tr>
					<th class="text-center">
						<input name="check_all" type="checkbox" class="check-all">
					</th>
					<th>{{ _('Platform') }}</th>
					<th>{{ _('Store Name') }}</th>
					<th class="text-center">{{ _('Type') }}</th>
					<th class="text-center">{{ _('Manager') }}</th>
					<th class="text-right">开通时间</th>
					<th class="text-right">{{ _('Status') }}</th>
					<th class="text-right">{{ _('Action') }}</th>
				</tr>
			</thead>
			<tbody>
	            {% for store in paginated_stores.items %}
				<tr>
	                <td class="text-center">
	                    <input name="selected[]" class="check-one" value="{{ store.serial_no }}" type="checkbox">
	                </td>
					<td>
						{{ store.platform_name }}
					</td>
					<td>
						{{ store.name }}
					</td>
					<td class="text-center">
						{{ store.type_label[1] }}
					</td>
					<td class="text-center">
						{{ store.operator.username }}
					</td>
					<td class="text-right">
						{{ store.created_at|timestamp2string(format='%Y-%m-%d %H:%M') }}
					</td>
					{% if store.platform == 1 %}
						<td class="text-right">
							<span class="indicator {{ store.wxapp.status_label[2] }}">{{ store.wxapp.status_label[1] }}</span>
						</td>
						<td class="text-right">
							<p>
			                    <a href="" class="btn-link" data-toggle="tooltip" data-original-title="{{ _('Edit') }}">
			                        {{ _('Related Orders') }}
			                    </a>
			                    <a href="{{ url_for('main.distribute_products', sn=store.serial_no) }}" class="btn-link ajax-modal m-l-10" data-modal="distribute-modal" data-toggle="tooltip" data-original-title="{{ _('Distribute Products') }}">
			                        {{ _('Distribute Products') }}
			                    </a>
	                            <a href="{{ url_for('main.wxapp_setting') }}?auth_app_id={{ store.wxapp.auth_app_id }}" class="btn-link m-l-10">
	                                <i class="fa fa-gear"></i> 基本设置
	                            </a>
							</p>
							<p>
	                            <a href="{{ url_for('main.wxapp_service') }}?auth_app_id={{ store.wxapp.auth_app_id }}" class="btn btn-default">
	                                <i class="fa fa-headphones"></i> 客服配置
	                            </a>
	                            <a href="{{ url_for('main.wxapp_templates') }}?auth_app_id={{ store.wxapp.auth_app_id }}" class="btn btn-default">
									<i class="fa fa-cubes"></i> 选择模板
								</a>
	                            <a href="{{ url_for('main.wxapp_versions') }}?auth_app_id={{ store.wxapp.auth_app_id }}" class="btn btn-mixpus">
									<i class="fa fa-upload"></i> 版本管理
								</a>
	                            
							</p>
						</td>
					{% else %}
						<td class="text-right">
							<span class="indicator {{ store.status_label[2] }}">{{ store.status_label[1] }}</span>
						</td>
						<td class="text-right">
		                    <a href="" class="btn-link" data-toggle="tooltip" data-original-title="{{ _('Edit') }}">
		                        {{ _('Related Orders') }}
		                    </a>
		                    <a href="{{ url_for('main.distribute_products', sn=store.serial_no) }}" class="btn-link ajax-modal m-l-10" data-modal="distribute-modal" data-toggle="tooltip" data-original-title="{{ _('Distribute Products') }}">
		                        {{ _('Distribute Products') }}
		                    </a>
							<a href="{{ url_for('main.edit_store', id=store.id) }}" class="m-l-10 btn-link">{{ _('Edit') }}</a>
						</td>
					{% endif %}
				</tr>
	            {% endfor %}
			</tbody>
		</table>
	</div>
</div>
{% endblock %}